/*
	PATCH TEST BASED ON THE FOLLOWING REFERENCE:
	R.H. MacNeal and R.L. Harder (1984). A proposed standard set of problems to test finite element accuracy.
	Finite Elements in Analysis and Design, Vol. 1, pp. 3-20
*/

## SEE FIG. 3 AND TAB. 2 OF REFERENCE FOR MORE DETAILS ON THIS TEST
TITLE "STATIC SOLVER TEST SERIES -- TEST 10: PATCH TEST 1 (MACNEAL, R.H. ET AL, 1984)"


## Analysis settings
BEGIN RUN_SETTINGS WITH ANALYSIS_TYPE = LINEAR_STATIC
	BEGIN OUTPUT WITH FILE = "test_10_patch_test_1", FORMAT = AXIS
		RECORD DISPLACEMENT ALL ON all_nodes
		RECORD STRAIN AT NODES ON SET all_nodes
		RECORD STRAIN AT ELEMENTS ON SET all_elements
		RECORD STRESS AT NODES ON SET all_nodes
		RECORD STRESS AT ELEMENTS ON SET all_elements
	END OUTPUT
END RUN_SETTINGS

/* Our nodes and elements are declared apart in another file. */
BEGIN NODES WITH SET_ID = all_nodes
	10,0.,0.,1.
	20,1.,0.,1.
	120,1.,0.,0.
	110,0.,0.,0.
	100,0.32,0.186,0.643
	202,0.677,0.305,0.683
	302,.826,.288,.288
	400,.249,.342,.192
	102,.165,.745,.702
	200,.788,.693,.644
	300,.850,.649,.263
	402,.273,.750,.230
	12,0,1,1
	22,1,1,1
	320,1,1,0
	420,0,1,0
/*	# INNER NODES
	1, 0.249, 0.342, 0.192
	2, 0.826, 0.288, 0.288
	3, 0.850, 0.649, 0.263
	4, 0.273, 0.750, 0.230
	5, 0.320, 0.186, 0.643
	6, 0.677, 0.305, 0.683
	7, 0.788, 0.693, 0.644
	8, 0.165, 0.745, 0.702
	
	# OUTER NODES (UNITY CUBE)
	9, 0.0, 0.0, 0.0
	10, 1.0, 0.0, 0.0
	11, 1.0, 1.0, 0.0
	12, 0.0, 1.0, 0.0
	13, 0.0, 0.0, 1.0
	14, 1.0, 0.0, 1.0
	15, 1.0, 1.0, 1.0
	16, 0.0, 1.0, 1.0*/
END NODES

BEGIN ELEMENTS WITH SET_ID = all_elements
1,10,20,120,110,100,202,302,400
2,10,100,400,110,12,102,402,420
3,100,202,302,400,102,200,300,402
4,202,20,120,302,200,22,320,300
5,102,200,300,402,12,22,320,420
6,302,120,110,400,300,320,420,402
7,20,202,100,10,22,200,102,12
/*	# Inner element
	1: 1, 2, 3, 4, 5, 6, 7, 8
	
	# Lateral elements
	2: 9, 10, 11, 12, 1, 5, 6, 2
	3: 12, 11, 15, 16, 2, 6, 7, 3
	4: 4, 8, 7, 3, 13, 14, 15, 16
	5: 13, 14, 10, 9, 4, 8, 5, 1

	# Front and back elements
	6: 10, 14, 15, 11, 5, 8, 7, 6
	7: 9, 12, 16, 13, 1, 2, 3, 4*/
END ELEMENTS


BEGIN PARTS WITH ELEM_TYPE = LINEAR_HEXAHEDRON, PROPERTIES = () # (INTEGRATION_TYPE = REDUCED)
	SET all_elements IS LINEAR_ISO_ELASTIC WITH POISSON = 0.25, ELASTIC_MODULUS = 1E6
END PARTS

BEGIN NODE_SET WITH ID = N10
	10
END NODE_SET

BEGIN NODE_SET WITH ID = N20
	20
END NODE_SET
BEGIN NODE_SET WITH ID = N120
	120
END NODE_SET
BEGIN NODE_SET WITH ID = N110
	110
END NODE_SET
BEGIN NODE_SET WITH ID = N12
	12
END NODE_SET
BEGIN NODE_SET WITH ID = N22
	22
END NODE_SET
BEGIN NODE_SET WITH ID = N320
	320
END NODE_SET
BEGIN NODE_SET WITH ID = N420
	420
END NODE_SET

BEGIN CONSTRAINTS
	SET N10  ON X DIRECTION HAS DISPLACEMENT = .5E-3
	SET N10  ON Y DIRECTION HAS DISPLACEMENT = .5E-3
	SET N10  ON Z DIRECTION HAS DISPLACEMENT = 1.E-3
	SET N20  ON X DIRECTION HAS DISPLACEMENT = 1.5E-3
	SET N20  ON Y DIRECTION HAS DISPLACEMENT = 1.E-3
	SET N20  ON Z DIRECTION HAS DISPLACEMENT = 1.5E-3
	SET N120 ON X DIRECTION HAS DISPLACEMENT = 1.E-3
	SET N120 ON Y DIRECTION HAS DISPLACEMENT = .5E-3
	SET N120 ON Z DIRECTION HAS DISPLACEMENT = .5E-3
	BLOCK MOVEMENT OF N110 ON ALL DIRECTIONS 
	SET N12  ON X DIRECTION HAS DISPLACEMENT = 1.E-3
	SET N12  ON Y DIRECTION HAS DISPLACEMENT = 1.5E-3
	SET N12  ON Z DIRECTION HAS DISPLACEMENT = 1.5E-3
	SET N22  ON X DIRECTION HAS DISPLACEMENT = 2.E-3
	SET N22  ON Y DIRECTION HAS DISPLACEMENT = 2.E-3
	SET N22  ON Z DIRECTION HAS DISPLACEMENT = 2.E-3
	SET N320 ON X DIRECTION HAS DISPLACEMENT = 1.5E-3
	SET N320 ON Y DIRECTION HAS DISPLACEMENT = 1.5E-3
	SET N320 ON Z DIRECTION HAS DISPLACEMENT = 1.E-3
	SET N420 ON X DIRECTION HAS DISPLACEMENT = .5E-3
	SET N420 ON Y DIRECTION HAS DISPLACEMENT = 1.E-3
	SET N420 ON Z DIRECTION HAS DISPLACEMENT = .5E-3
	
	
	/*
	SET N9  ON X DIRECTION HAS DISPLACEMENT = 0
	SET N9  ON Y DIRECTION HAS DISPLACEMENT = 0
	SET N9  ON Z DIRECTION HAS DISPLACEMENT = 0
	SET N10 ON X DIRECTION HAS DISPLACEMENT = 1e-3
	SET N10 ON Y DIRECTION HAS DISPLACEMENT = 0.5e-3
	SET N10 ON Z DIRECTION HAS DISPLACEMENT = 0.5e-3
	SET N11 ON X DIRECTION HAS DISPLACEMENT = 1.5e-3
	SET N11 ON Y DIRECTION HAS DISPLACEMENT = 1.5e-3
	SET N11 ON Z DIRECTION HAS DISPLACEMENT = 1e-3
	SET N12 ON X DIRECTION HAS DISPLACEMENT = 0.5e-3
	SET N12 ON Y DIRECTION HAS DISPLACEMENT = 1e-3
	SET N12 ON Z DIRECTION HAS DISPLACEMENT = 0.5e-3
	SET N13 ON X DIRECTION HAS DISPLACEMENT = 0.5e-3
	SET N13 ON Y DIRECTION HAS DISPLACEMENT = 0.5e-3
	SET N13 ON Z DIRECTION HAS DISPLACEMENT = 1e-3
	SET N14 ON X DIRECTION HAS DISPLACEMENT = 1.5e-3
	SET N14 ON Y DIRECTION HAS DISPLACEMENT = 1e-3
	SET N14 ON Z DIRECTION HAS DISPLACEMENT = 1.5e-3
	SET N15 ON X DIRECTION HAS DISPLACEMENT = 2e-3
	SET N15 ON Y DIRECTION HAS DISPLACEMENT = 2e-3
	SET N15 ON Z DIRECTION HAS DISPLACEMENT = 2e-3
	SET N16 ON X DIRECTION HAS DISPLACEMENT = 1e-3
	SET N16 ON Y DIRECTION HAS DISPLACEMENT = 1.5e-3
	SET N16 ON Z DIRECTION HAS DISPLACEMENT = 1.5e-3
	*/
END CONSTRAINTS

